<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="SyncMedia.WinUI.Views.VideoAdWithProgressPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Background="{ThemeResource SolidBackgroundFillColorBaseBrush}">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header with progress info -->
        <Border Grid.Row="0" 
                Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                BorderThickness="0,0,0,1"
                Padding="24,16">
            <StackPanel Spacing="12">
                <TextBlock Text="Watch ad to continue syncing"
                           Style="{StaticResource SubtitleTextBlockStyle}"/>
                
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <StackPanel Grid.Column="0" Spacing="4">
                        <TextBlock>
                            <Run Text="Files processed:"/>
                            <Run x:Name="FilesProcessedText" Text="0" FontWeight="SemiBold"/>
                            <Run Text="/"/>
                            <Run x:Name="FilesRemainingText" Text="0" FontWeight="SemiBold"/>
                        </TextBlock>
                        <TextBlock x:Name="CurrentFileText"
                                   Text="Processing..."
                                   Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                   TextTrimming="CharacterEllipsis"/>
                    </StackPanel>
                    
                    <StackPanel Grid.Column="1" Spacing="4" HorizontalAlignment="Right">
                        <TextBlock Text="Reward for watching:"
                                   FontSize="12"
                                   Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xE730;" FontSize="16" Foreground="{ThemeResource SystemAccentColor}"/>
                            <TextBlock Text="+20 files" FontWeight="SemiBold" Foreground="{ThemeResource SystemAccentColor}"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xE916;" FontSize="16" Foreground="{ThemeResource SystemAccentColor}"/>
                            <TextBlock Text="60min speed boost" FontWeight="SemiBold" Foreground="{ThemeResource SystemAccentColor}"/>
                        </StackPanel>
                    </StackPanel>
                </Grid>
            </StackPanel>
        </Border>

        <!-- Video Ad Area (InterstitialAd will be shown here) -->
        <Border Grid.Row="1"
                Background="#000000"
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                Padding="0">
            <StackPanel Spacing="24" 
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center">
                
                <!-- Placeholder for video ad -->
                <FontIcon Glyph="&#xE768;" 
                          FontSize="72"
                          Foreground="White"/>
                
                <TextBlock Text="Loading video ad..."
                           FontSize="20"
                           Foreground="White"
                           HorizontalAlignment="Center"/>
                
                <ProgressRing x:Name="LoadingRing"
                              IsActive="True"
                              Width="40"
                              Height="40"
                              Foreground="White"/>
            </StackPanel>
        </Border>

        <!-- Footer with sync queue info -->
        <Border Grid.Row="2"
                Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                BorderThickness="0,1,0,0"
                Padding="24,16">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <!-- Progress bar and info -->
                <StackPanel Grid.Column="0" Spacing="8">
                    <StackPanel Orientation="Horizontal" Spacing="12">
                        <TextBlock Text="Sync Progress:" VerticalAlignment="Center"/>
                        <ProgressBar x:Name="SyncProgressBar"
                                     Width="300"
                                     Height="4"
                                     VerticalAlignment="Center"/>
                        <TextBlock x:Name="ProgressPercentText"
                                   Text="0%"
                                   VerticalAlignment="Center"
                                   FontWeight="SemiBold"/>
                    </StackPanel>
                    
                    <TextBlock x:Name="StatusText"
                               Text="Waiting to resume sync..."
                               FontSize="12"
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                </StackPanel>

                <!-- Skip button (only available after minimum watch time) -->
                <Button x:Name="SkipButton"
                        Grid.Column="1"
                        Content="Skip (Partial Reward)"
                        IsEnabled="False"
                        Click="SkipButton_Click"
                        ToolTipService.ToolTip="Available after 15 seconds"/>
            </Grid>
        </Border>

        <!-- Info overlay (shown if video fails to load) -->
        <Border x:Name="ErrorOverlay"
                Grid.Row="1"
                Background="{ThemeResource AcrylicBackgroundFillColorDefaultBrush}"
                Visibility="Collapsed"
                Padding="48">
            <StackPanel Spacing="16"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        MaxWidth="400">
                <FontIcon Glyph="&#xE7BA;" 
                          FontSize="48"
                          Foreground="{ThemeResource SystemErrorTextColor}"/>
                
                <TextBlock Text="Unable to load video ad"
                           Style="{StaticResource SubtitleTextBlockStyle}"
                           TextAlignment="Center"/>
                
                <TextBlock Text="Please check your internet connection and try again."
                           TextAlignment="Center"
                           TextWrapping="Wrap"
                           Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                
                <StackPanel Orientation="Horizontal" 
                            Spacing="12"
                            HorizontalAlignment="Center"
                            Margin="0,16,0,0">
                    <Button Content="Retry"
                            Style="{StaticResource AccentButtonStyle}"
                            Click="RetryButton_Click"/>
                    <Button Content="Upgrade to Pro"
                            Click="UpgradeButton_Click"/>
                </StackPanel>
            </StackPanel>
        </Border>
    </Grid>
</Page>
