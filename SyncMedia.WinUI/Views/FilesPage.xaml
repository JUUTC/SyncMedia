<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="SyncMedia.WinUI.Views.FilesPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <Grid Padding="24" RowSpacing="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- Page Header -->
        <StackPanel Grid.Row="0" Spacing="8">
            <TextBlock Text="Sync Results" Style="{StaticResource TitleTextBlockStyle}" />
            <TextBlock Text="View and manage synchronization results" 
                       Style="{StaticResource BodyTextBlockStyle}" 
                       Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
        </StackPanel>

        <!-- Search and Filter Bar -->
        <Grid Grid.Row="1" ColumnSpacing="12">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <TextBox Grid.Column="0" 
                     PlaceholderText="Search files..." 
                     Text="{x:Bind ViewModel.SearchText, Mode=TwoWay}">
                <TextBox.KeyboardAccelerators>
                    <KeyboardAccelerator Key="Enter" 
                                         Invoked="{x:Bind ViewModel.SearchCommand}" />
                </TextBox.KeyboardAccelerators>
            </TextBox>

            <ComboBox Grid.Column="1" 
                      PlaceholderText="Filter by status" 
                      SelectedItem="{x:Bind ViewModel.FilterStatus, Mode=TwoWay}"
                      MinWidth="150">
                <x:String>All</x:String>
                <x:String>Success</x:String>
                <x:String>Error</x:String>
                <x:String>Skipped</x:String>
            </ComboBox>

            <Button Grid.Column="2" 
                    Command="{x:Bind ViewModel.ExportResultsCommand}">
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <FontIcon Glyph="&#xE74E;" FontSize="16" />
                    <TextBlock Text="Export" />
                </StackPanel>
            </Button>

            <Button Grid.Column="3" 
                    Command="{x:Bind ViewModel.ClearResultsCommand}">
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <FontIcon Glyph="&#xE74D;" FontSize="16" />
                    <TextBlock Text="Clear" />
                </StackPanel>
            </Button>
        </Grid>

        <!-- Results DataGrid -->
        <Border Grid.Row="2"
                Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                BorderThickness="1"
                CornerRadius="8">
            <Grid>
                <!-- Empty State -->
                <StackPanel HorizontalAlignment="Center" 
                            VerticalAlignment="Center"
                            Spacing="12"
                            Visibility="{x:Bind ViewModel.SyncResults.Count, Mode=OneWay, Converter={StaticResource EmptyToVisibilityConverter}}">
                    <FontIcon Glyph="&#xE8F1;" FontSize="48" 
                              Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                    <TextBlock Text="No sync results yet" 
                               Style="{StaticResource SubtitleTextBlockStyle}"
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                    <TextBlock Text="Run a sync operation to see results here" 
                               Foreground="{ThemeResource TextFillColorTertiaryBrush}" />
                </StackPanel>

                <!-- Results List -->
                <ListView ItemsSource="{x:Bind ViewModel.SyncResults, Mode=OneWay}"
                          SelectedItem="{x:Bind ViewModel.SelectedResult, Mode=TwoWay}"
                          SelectionMode="Single">
                    <ListView.ItemTemplate>
                        <DataTemplate x:DataType="local:SyncFileResult">
                            <Grid Padding="12" ColumnSpacing="12">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <!-- Status Icon -->
                                <FontIcon Grid.Column="0" 
                                          Glyph="{x:Bind StatusIcon}" 
                                          FontSize="20" />

                                <!-- File Info -->
                                <StackPanel Grid.Column="1" Spacing="4">
                                    <TextBlock Text="{x:Bind FileName}" 
                                               Style="{StaticResource BodyStrongTextBlockStyle}" />
                                    <TextBlock Text="{x:Bind FilePath}" 
                                               Style="{StaticResource CaptionTextBlockStyle}"
                                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                               TextTrimming="CharacterEllipsis" />
                                </StackPanel>

                                <!-- File Size -->
                                <TextBlock Grid.Column="2" 
                                           Text="{x:Bind FileSizeFormatted}" 
                                           VerticalAlignment="Center"
                                           Foreground="{ThemeResource TextFillColorSecondaryBrush}" />

                                <!-- Action -->
                                <TextBlock Grid.Column="3" 
                                           Text="{x:Bind Action}" 
                                           VerticalAlignment="Center"
                                           Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                           MinWidth="80" />

                                <!-- Timestamp -->
                                <TextBlock Grid.Column="4" 
                                           Text="{x:Bind Timestamp}" 
                                           VerticalAlignment="Center"
                                           Foreground="{ThemeResource TextFillColorTertiaryBrush}" />
                            </Grid>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
            </Grid>
        </Border>
    </Grid>
</Page>
